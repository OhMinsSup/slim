define(function(){"use strict";function t(){}var e=function(t){return"[object Object]"===Object.prototype.toString.call(t)},n=function(t){return"string"==typeof t},r=function(t){throw new Error(t)},o=window.console.warn,i=function(t,e){t&&r(e)},u=function(t,e){t&&o(e)},a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},c=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},s="Function",_=function(t){return Object.keys(t).forEach(function(e){var n=t[e];i("function"!=typeof n,"Reducer for key ["+e+"] must be type of [fnT] but got ["+(void 0===n?"undefined":a(n))+"]")}),t},d=function(t){return Object.keys(t).forEach(function(e){var n=t[e];i("function"!=typeof n,g.shouldBe("Getter."+e,s,void 0===n?"undefined":a(n)))}),t},y=function(t){if(!t)return[];var e=Array.isArray(t)?t:[t];return e.forEach(function(t){l(t)}),e},l=function(t){i(!e(t),g.shouldBe("Plugin","Object",void 0===t?"undefined":a(t)));var n=t.before,r=t.after;n&&i("function"!=typeof n,g.shouldBe("Plugin.before",s,void 0===n?"undefined":a(n))),r&&i("function"!=typeof r,g.shouldBe("Plugin.after",s,void 0===r?"undefined":a(r)))},p=function(t,e){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];e&&e.forEach(function(e){v.apply(void 0,[t,e].concat(r))})},v=function(t,e){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];e[t]&&e[t].apply(e,r)},g={typeError:function(t){return"type of state expect to [Object] but got ["+t+"]"},shouldBe:function(t,e,n){return t+" should be type of ["+e+"] but got ["+n+"]"},cantCall:function(t){return"You may not call "+t+" while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store."},cantAssign:function(){return"You may not be able to assign values ​​directly to state. Please return a new state for reducing or edit with state in reducer."}},h=function(t){return JSON.parse(JSON.stringify(t))},O=function(t){return e(t)?t:JSON.parse(t)},S=[],E=null,m=!1,b=void 0,w=function(t){var r=t.reducers,o=void 0===r?{}:r,s=t.state,l=void 0===s?{}:s,v=t.plugin,h=t.getters,O=void 0===h?{}:h,w=t.mode,L=void 0===w?"strict":w;if(!e(l))throw new TypeError(g.typeError(void 0===l?"undefined":a(l)));m="strict"===L;var T=A(l),I=_(f({},o,{__SLIM_DEVTOOL_SET__:function(t,e){return e}})),N=[].concat(S,c(y(v)));O=d(O);var V=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];i(!n(t),g.shouldBe("Actions","string",void 0===t?"undefined":a(t))),i(E,"Reducers may not dispatch actions.");try{if(E=t,u(!I[t],"You may not has not registered ["+t+"] in store"),p("before",N),I[t]){var f=I[t].apply(I,[T].concat(r));f&&f!==T&&(T=A(f),b.state=T)}p("after",N)}finally{E=null}return b};return b={dispatch:V,getState:function(t){return i(E,g.cantCall("store.getState()")),u(t&&!O.hasOwnProperty(t),"Getter of key ["+t+"] is not exist. Please register it with when createStore."),t?O[t]?O[t](T):void 0:T},state:T,getters:O},p("init",N),b},A=function(t){var n=function(t){return e(t)?r(t):Array.isArray(t)?r(t,!0):t},r=function(t,e){var r={set:function(t,e,r){return i(!E,g.cantAssign()),Reflect.set(t,e,n(h(r)))},get:function(t,e){return Reflect.get(t,e)}},o=f({},r,{set:function(t,e,r){if("__proto__"===e)return Reflect.set(t,e,r);if(E)return Reflect.set(t,e,n(h(r)));throw new Error(g.cantAssign())}});for(var u in t)t[u]=n(t[u]);return new Proxy(t,e?o:r)};return m?r(t):t},L=function(t){l(t),S.push(t)},T={},I={on:function(t,e){T[t]||(T[t]=[]),T[t].push(e)},off:function(t,e){var n=T[t];if(Array.isArray(n)){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}},emit:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var o=T[t];u(!o,"there are no handler for event ["+t+"]"),o&&o.forEach(function(t){t.apply(void 0,c(n))})}},N=require("./package.json").version,V="production"!==process.env.NODE_ENV;u(V&&"string"==typeof t.name&&"isCrushed"!==t.name,'You are currently using minified code outside of NODE_ENV === "production". This means that you are running a slower development build of Slim. ');var D=I.on,M=I.off,R=I.emit,j={__VERSION__:N,createStore:function(){return V&&L({init:function(t){var e=function(){window.postMessage({version:N,type:"__SLIM_DEVTOOL_INIT_ANSWER__",state:JSON.stringify(t.getState())},"*")};setTimeout(function(){e()},500),window.addEventListener("message",function(t){var n=O(t.data),r=n.type,o=n.state;"__SLIM_DEVTOOL_ANSWER__"===r?j.emit("__SLIM_DEVTOOL_ANSWER__",O(o)):"__SLIM_DEVTOOL_INIT__"===r&&e()})},after:function(t,e){-1===["__SLIM_DEVTOOL_INIT__","__SLIM_DEVTOOL_INIT_ANSWER__","__SLIM_DEVTOOL_ANSWER__","__SLIM_DEVTOOL_SET__","__SLIM_DEVTOOL__"].indexOf(e)&&window.postMessage({version:N,type:"__SLIM_DEVTOOL__",state:JSON.stringify(t),actionType:e},"*")}}),w}(),use:L,on:D,off:M,emit:R};return j});
