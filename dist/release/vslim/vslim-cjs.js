"use strict";function isCrushed(){}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},isPlainObject=function(e){if("object"!==(void 0===e?"undefined":_typeof(e))||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},isPlainString=function(e){return"string"==typeof e},warn=window.console.warn,error=function(e){throw new Error(e)},throwIf=function(e,t){e&&error(t)},warnIf=function(e,t){e&&warn(t)},EventCenter=function(){function e(){classCallCheck(this,e),this.eventMap=[]}return createClass(e,[{key:"on",value:function(e,t){this.eventMap[e]||(this.eventMap[e]=[]),this.eventMap[e].push(t)}},{key:"off",value:function(e,t){var n=this.eventMap[e];if(Array.isArray(n)){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},{key:"emit",value:function(e){var t=this.eventMap[e];warnIf(!t,"there are no handler for event ["+e+"]");for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];t&&t.apply(void 0,r)}}]),e}(),isDispatching=null,fnT="Function",createStore=function(e){var t=e.reducers,n=void 0===t?{}:t,r=e.state,o=void 0===r?{}:r,i=e.plugin,s=e.aliases,a=void 0===s?{}:s,f=e.mode,u=void 0===f?"strict":f;if(!isPlainObject(o))throw new TypeError(msgHelper.typeError(void 0===o?"undefined":_typeof(o)));var c=new EventCenter,l=c.on,p=c.off,d=c.emit,h=observeObject(o,u),y=passReducer(n),g=passPlugin(i);a=passAlias(a);var v=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];throwIf(!isPlainString(e),msgHelper.shouldBe("Actions","string",void 0===e?"undefined":_typeof(e))),throwIf(isDispatching,"Reducers may not dispatch actions.");try{if(isDispatching=e,warnIf(!n[e],"You may not has not registered ["+e+"] in store"),walkPlugins("before",g,h,e),y[e]){var i=y[e].apply(y,[h].concat(r));i&&i!==h&&(h=observeObject(i,u))}walkPlugins("after",g,h,e)}finally{isDispatching=null}return m},w=function(e){return throwIf(isDispatching,msgHelper.cantCall("store.getState()")),warnIf(e&&!a.hasOwnProperty(e),"Alias of key ["+e+"] is not exist. Please register it with when createStore."),e?a[e]?a[e](h):void 0:h},b=function(e){validatePlugin(e),throwIf(isDispatching,msgHelper.cantCall("removeMiddleware()")),g?g.push(e):g=[e]},m=new Proxy({on:l,off:p,emit:d,dispatch:v,getState:w,applyPlugin:b,state:h},{get:function(e,t){return"state"===t?h:Reflect.get(e,t)},set:function(){throwIf(!isDispatching,msgHelper.cantAssign())}});return m},observeObject=function(e,t){var n=function(e){return isPlainObject(e)?r(e):Array.isArray(e)?r(e,!0):e},r=function(e,t){var r={set:function(e,t,r){return throwIf(!isDispatching,msgHelper.cantAssign()),Reflect.set(e,t,n(cloneObj(r)))},get:function(e,t){return Reflect.get(e,t)}},o=_extends({},r,{set:function(e,t,r){if("__proto__"===t)return Reflect.set(e,t,r);if(isDispatching)return Reflect.set(e,t,n(cloneObj(r)));throw new Error(msgHelper.cantAssign())}});for(var i in e)e[i]=n(e[i]);return new Proxy(e,t?o:r)};switch(t){case"strict":return r(e);case"loose":return e}},passReducer=function(e){return Object.keys(e).forEach(function(t){var n=e[t];throwIf("function"!=typeof n,"Reducer for key ["+t+"] must be type of [fnT] but got ["+(void 0===n?"undefined":_typeof(n))+"]")}),e},passAlias=function(e){return Object.keys(e).forEach(function(t){var n=e[t];throwIf("function"!=typeof n,msgHelper.shouldBe("Alias."+t,fnT,void 0===n?"undefined":_typeof(n)))}),e},passPlugin=function(e){if(e){var t=Array.isArray(e)?e:[e];return t.forEach(function(e){validatePlugin(e)}),t}},validatePlugin=function(e){var t=e.before,n=e.after;t&&throwIf("function"!=typeof t,msgHelper.shouldBe("Plugin.after",fnT,void 0===t?"undefined":_typeof(t))),n&&throwIf("function"!=typeof n,msgHelper.shouldBe("Plugin.after",fnT,void 0===n?"undefined":_typeof(n)))},walkPlugins=function(e,t,n,r){t&&t.forEach(function(t){t[e]&&t[e](n,r)})},msgHelper={typeError:function(e){return"type of state expect to [Object] but got ["+e+"]"},shouldBe:function(e,t,n){return e+" should be type of ["+t+"] but got ["+n+"]"},cantCall:function(e){return"You may not call "+e+" while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store."},cantAssign:function(){return"You may not be able to assign values ​​directly to state. Please return a new state for reducing or edit with state in reducer."}},cloneObj=function(e){return JSON.parse(JSON.stringify(e))};warnIf("production"!==process.env.NODE_ENV&&"string"==typeof isCrushed.name&&"isCrushed"!==isCrushed.name,'You are currently using minified code outside of NODE_ENV === "production". This means that you are running a slower development build of Slim. ');var index={createStore:createStore,install:function(e){function t(){var e=this,t=this.$options;t.store?(this.store="function"==typeof t.store?_extends({},t.store(),{state:t.store.getState()}):_extends({},t.store,{state:t.store.getState()}),this.store.applyPlugin({after:function(t){e.$children[0].$forceUpdate()}})):t.parent&&t.parent.store&&(this.store=t.parent.store)}if(Number(e.version.split(".")[0])>=2)e.mixin({created:t,data:function(){return{store:null}}});else{var n=e.prototype._init;e.prototype._init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.init=e.init?[t].concat(e.init):t,n.call(this,e)}}}};module.exports=index;
